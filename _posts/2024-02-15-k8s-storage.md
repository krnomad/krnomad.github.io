---
layout: post
date: 2024-02-15
title: "k8s storage"
tags: [openebs, k8s, ]
categories: [kubernetes, ]
pin: true
---


### 설치


[https://github.com/openebs/charts](https://github.com/openebs/charts)


kubectl apply -f [https://raw.githubusercontent.com/openebs/charts/gh-pages/openebs-operator.yaml](https://raw.githubusercontent.com/openebs/charts/gh-pages/openebs-operator.yaml)


## 테스트


### pvc 생성


{% raw %}
```bash
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: default-pvc
  namespace: default
spec:
  accessModes:
  - ReadWriteOnce  
  resources:
    requests:
      storage: 1Gi
  storageClassName: "openebs-hostpath"
```
{% endraw %}


### pvc를 사용하는 deployment 생성

undefined
## storage IOPS 확인


### kubestr 설치


[https://github.com/kastenhq/kubestr/releases/download/v0.4.16/kubestr-v0.4.16-linux-amd64.tar.gz](https://github.com/kastenhq/kubestr/releases/download/v0.4.16/kubestr-v0.4.16-linux-amd64.tar.gz)


### fio 스크립트 작성


[https://github.com/axboe/fio/tree/master/examples?source=post_page-----56438efb23b7--------------------------------](https://github.com/axboe/fio/tree/master/examples?source=post_page-----56438efb23b7--------------------------------)


{% raw %}
```bash
; fio-rand-read.job for fiotest

[global]
name=fio-rand-read
filename=fio-rand-read
rw=randread
bs=4K
direct=0
numjobs=1
time_based
runtime=900

[file1]
size=10G
ioengine=libaio
iodepth=16
```
{% endraw %}


### kubestr 실행


{% raw %}
```bash
kubestr fio -f fio-rand-read-Diamanti.fio -s openebs-hostpath
```
{% endraw %}


# Link


[https://jerryljh.medium.com/kubestr-kube-storage-iops-측정-툴-56438efb23b7](https://jerryljh.medium.com/kubestr-kube-storage-iops-%EC%B8%A1%EC%A0%95-%ED%88%B4-56438efb23b7)

